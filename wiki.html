<html>

<body>
<!-- Search area -->
<h1>Your search:</h1>
<input type="text" id="wikilink" size="50"/>
<button id="submit" type="submit" onclick="search()">Process</button>

<br />

<h1>Linked wiki pages</h1>
<p id="links">
</p>

<h1>Present in:</h1>
<p id="categories">
</p>

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

<script>

$(document).ready(function() { 
   ajaxRequests = 0;
   $('#wikilink').focus();
});
// Request Wikipedia's API for metadata
function search() {
   $('#links').empty(); 
   $('#categories').empty();
   $('#submit').html('Searching...');

   url = $('#wikilink').val();
   split = url.split("/");
   name = split[split.length - 1];

   $.ajax({
   url:"http://en.wikipedia.org/w/api.php?action=query&prop=links&format=json&&plnamespace=0&pllimit=max&titles=" + name,
   type:'GET',
   dataType:'JSONP',
   success: parselinks,
   });
   ajaxRequests++;

   $.ajax({
   url:"http://en.wikipedia.org/w/api.php?action=query&prop=categories&format=json&clshow=!hidden&titles=" + name,
   type:'GET',
   dataType:'JSONP',
   success: parseCategories,
   });
   ajaxRequests++;
}

function parselinks(data) {
   for (page in data.query.pages) {
      for (key in data.query.pages[page].links) {
         $('#links').append('<a href="http://en.wikipedia.org/wiki/' + data.query.pages[page].links[key].title.replace(' ', '_') + '">' + data.query.pages[page].links[key].title + '</a><br/>');
      }
   }

   ajaxRequests--;
   if (ajaxRequests == 0) {
      $('#submit').html('Process');
   }
}

function parseCategories(data) {
   for (page in data.query.pages) {
     for (key in data.query.pages[page].categories) {
         $('#categories').append('<a href="http://en.wikipedia.org/wiki/' + data.query.pages[page].categories[key].title.replace(' ', '_') + '">' + data.query.pages[page].categories[key].title + '</a><br/>');
     }

   }
   ajaxRequests--;
   if (ajaxRequests == 0) {
      $('#submit').html('Process');
   }
}
</script>

</body>
</html>
